package edu.usfca.dataflow.jobs1;

import static edu.usfca.dataflow.__TestHelper.areDeviceProfileSetsEqual;
import static edu.usfca.dataflow.__TestHelper.getCanonicalId;
import static edu.usfca.dataflow.__TestHelper.getDpWithCanonicalId;
import static edu.usfca.dataflow.transforms.SuspiciousIDs.getSuspiciousIDs;
import static org.junit.Assert.assertEquals;
import static org.junit.Assert.assertTrue;

import java.util.Arrays;
import java.util.Base64;
import java.util.Set;
import java.util.function.Function;
import java.util.stream.Collectors;
import java.util.stream.StreamSupport;

import org.apache.beam.sdk.options.PipelineOptions.CheckEnabled;
import org.apache.beam.sdk.testing.PAssert;
import org.apache.beam.sdk.testing.TestPipeline;
import org.apache.beam.sdk.transforms.Create;
import org.apache.beam.sdk.transforms.MapElements;
import org.apache.beam.sdk.values.PCollection;
import org.apache.beam.sdk.values.TypeDescriptor;
import org.junit.Before;
import org.junit.Rule;
import org.junit.Test;
import org.junit.rules.Timeout;

import com.google.common.collect.Iterables;
import com.google.protobuf.InvalidProtocolBufferException;

import edu.usfca.dataflow.jobs1.BidLogJob.BidLog2DeviceProfile;
import edu.usfca.dataflow.transforms.AppProfiles.ComputeAppProfiles;
import edu.usfca.protobuf.Common.DeviceId;
import edu.usfca.protobuf.Common.OsType;
import edu.usfca.protobuf.Profile.AppProfile;
import edu.usfca.protobuf.Profile.DeviceProfile;

/**
 * This class tests your pipeline's correctness by using 109 BidLogs (which are all valid).
 */
public class __Test09BidLogJob {
  @Rule
  public Timeout timeout = Timeout.millis(10000);

  @Rule
  public final transient TestPipeline tp = TestPipeline.create();

  @Before
  public void before() {
    tp.getOptions().setStableUniqueNames(CheckEnabled.OFF);
  }

  // NOTE: It may be a good idea to decode these Base64-encoded proto messages (BidLogs),
  // and print them to the console so you can see the contents.
  static String[] bidLogsB64 = new String[] {
      "CoABCg5pZDA5MDgwLTU4ODI0MSIKQghhcHAuMTIzNCo3IgkaA3VzYSICQ0FyA2lvc6IBJDAxMDRmMmQwLTkyODMtNGMyNi1iZDgwLWQxMmRiODdmZTMzY2IIYmExNjY2MzSCAQhiYTI2MjM1OYoBCGJhNjUzOTc5igEIYmE1MzgwODUQFRig8wIgiPYHKAEw8So=",
      "CmoKDmlkMDI3OTItNTgzMzE2IgpCCGFwcC4xMjM0KjciCRoDdXNhIgJjYXIDaW9zogEkMDEwNGYyZDAtOTI4My00YzI2LWJkODAtZDEyZGI4N2ZlMzNjYghiYTQ0MTU2MooBCGJhODA2MzM1EAIY65oFIKuSDygBMIZM",
      "CnUKDmlkMDI1ODItOTk0MDk5IgpCCGFwcC4xMjM0KjciCRoDdXNhIgJDQXIDSU9TogEkMDEwNGYyZDAtOTI4My00YzI2LWJkODAtZDEyZGI4N2ZlMzNjYghiYTIyMDI5MoIBCGJhMzE5NTIwigEIYmExODAyMDUQFRij0QQggKsNKAEw+IEC",
      "CoABCg5pZDA2MDg3LTEwNjU1MyIKQghhcHAuMTIzNCo3IgkaA3VzYSICY2FyA2lvc6IBJDAxMDRmMmQwLTkyODMtNGMyNi1iZDgwLWQxMmRiODdmZTMzY2oIYmE2NDQyOTOCAQhiYTY5NDIwOIoBCGJhNzAzNTE1igEIYmE0MDIzNDEQAhikZyDK0wYoATDOgAE=",
      "CmsKDmlkMDE4MzItODAxMzY0IgpCCGFwcC4xMjM0KjciCRoDdXNhIgJueXIDaW9zogEkMTgzNWVkNTMtMzA3Zi00YTQ1LThkODMtZmI0NDhhODViOTI5aghiYTM1NDI4NIoBCWJhMTE5NTY0MBAVGI+cBSDkpQooATD4jQE=",
      "CmAKDmlkMDAzODQtMDMyMTA1IgpCCGFwcC4xMjM0KjciCRoDdXNhIgJOWXIDaU9zogEkMTgzNWVkNTMtMzA3Zi00YTQ1LThkODMtZmI0NDhhODViOTI5igEIYmEyNTM4MDQQAhiD3AMglt0LKAEw5r4B",
      "CmsKDmlkMDc4NjMtODk5MTA0IgpCCGFwcC4xMjM0KjciCRoDVVNBIgJueXIDaW9zogEkMTgzNWVkNTMtMzA3Zi00YTQ1LThkODMtZmI0NDhhODViOTI5agliYTExNTMwODeCAQhiYTkwMzUyNBACGOT9BCCdlQwoATCFZg==",
      "CngKDmlkMDY0OTktMDU2MzM5IgpCCEFwcC4xMjM0KjciCRoDdXNhIgJDQXIDaW9zogEkMmQ0MDVlOWEtNTZjYy00ZDVhLThkY2MtODU3NzhkOGJmN2Q3ggEJYmExMjA1NDI1ggEIYmE5MzMyMjeKAQliYTEyMzgwNTUQFhjVxAMglasIKAEw44UB",
      "CnUKDmlkMDg0NTQtOTczMTE0IgpCCEFwcC4xMjM0KjciCRoDdXNhIgJjYXIDaW9zogEkMmQ0MDVlOWEtNTZjYy00ZDVhLThkY2MtODU3NzhkOGJmN2Q3agliYTEyMTA0MzCCAQhiYTE5NTg4NIoBB2JhOTI1MzQQAhim0gMgtKEPKAEwqqEB",
      "Cl8KDmlkMDk4MTQtNTk0NzY1IgpCCEFwcC4xMjM0KjciCRoDdXNhIgJDQXIDSU9TogEkMmQ0MDVlOWEtNTZjYy00ZDVhLThkY2MtODU3NzhkOGJmN2Q3YghiYTM1NDU3MBAWGKS7BCCBmw0oATC6Dw==",
      "Cn8KDmlkMDE2NjktNzc3NzMxIgpCCEFwcC4xMjM0KjciCRoDdXNhIgJjYXIDaW9zogEkMmQ0MDVlOWEtNTZjYy00ZDVhLThkY2MtODU3NzhkOGJmN2Q3aghiYTE3Mzc3NmoHYmE5NDk4NIIBCGJhNTE5NjQ3ggEJYmExMjQ2NDc1EAIYyJcEIILdCCgBMKLWAQ==",
      "CnQKDmlkMDE3MTAtMjY2MTQxIgpCCEFwcC4xMjM0KjciCRoDdXNhIgJueXIDaW9zogEkMzEwNDIxOWEtMTFhNi00ZDRlLTk0ZGEtZThlMzdiMjdkMDNhYghiYTI4NTU0MWIIYmE1Njc2NjGCAQhiYTM3Nzc5MhAVGOyrASCuiAooATCpkwE=",
      "CmsKDmlkMDgxNzMtNzcwNzI1IgpCCEFwcC4xMjM0KjciCRoDdXNhIgJOWXIDaU9zogEkMzEwNDIxOWEtMTFhNi00ZDRlLTk0ZGEtZThlMzdiMjdkMDNhagliYTEwNTEyMTCCAQhiYTk0NjA1OBAJGJqwAyCr5wwoATDOQA==",
      "CpQBCg5pZDA4MzIxLTU5MzE3NSIKQghBcHAuMTIzNCo3IgkaA1VTQSICbnlyA2lPU6IBJDMxMDQyMTlhLTExYTYtNGQ0ZS05NGRhLWU4ZTM3YjI3ZDAzYWIIYmE2MjI3ODRiCWJhMTEyMDgzMGoIYmE1ODYyNDNqCGJhMzQ5MTA4ggEIYmEzMzg3NzWKAQhiYTMxMTQxNhACGJrlBCDfog8oATC1nAE=",
      "CmQKDmlkMDY0MjgtNTIxMzI5Ig5CDEFwcC5mc29jaWV0eSo3IgkaA3VzYSICQ0FyA2lvc6IBJDAxMDRmMmQwLTkyODMtNGMyNi1iZDgwLWQxMmRiODdmZTMzY4IBCGJhNjM1MDc3EBUYgaYBIIqiCSgBMJ7jAQ==",
      "CmQKDmlkMDMxNjYtNjc5NTU2Ig5CDEFwcC5mc29jaWV0eSo3IgkaA3VzYSICY2FyA2lvc6IBJDAxMDRmMmQwLTkyODMtNGMyNi1iZDgwLWQxMmRiODdmZTMzY4oBCGJhNTA1MjgzEAIYg9IEILn/BigBMNIc",
      "CpgBCg5pZDA5MTA4LTA1ODgwNSIOQgxBcHAuZnNvY2lldHkqNyIJGgN1c2EiAm55cgNpb3OiASQxODM1ZWQ1My0zMDdmLTRhNDUtOGQ4My1mYjQ0OGE4NWI5MjliCWJhMTEyODI3NGIIYmExMDYzNDdqCGJhNzQxNDkwaghiYTg0NDY2NIIBCGJhODQzODgyigEIYmE1NTg5OTMQFRj83AIgrvsMKAEw0HI=",
      "Cm8KDmlkMDM1NzEtNjIyOTgyIg5CDEFwcC5mc29jaWV0eSo3IgkaA3VzYSICTllyA2lPc6IBJDE4MzVlZDUzLTMwN2YtNGE0NS04ZDgzLWZiNDQ4YTg1YjkyOWIIYmExMzE1NTCKAQliYTExMDAwNjYQAhjbsgIgmvIQKAEwsCk=",
      "CoQBCg5pZDAzMjA3LTk2NTE3OCIOQgxBcHAuZnNvY2lldHkqNyIJGgN1c2EiAkNBcgNpb3OiASQyZDQwNWU5YS01NmNjLTRkNWEtOGRjYy04NTc3OGQ4YmY3ZDdiCWJhMTA0MDE2NWIJYmExMTYxMjE2aghiYTI4MjY0OYoBCGJhNDA4Mjg1EBYY1YoFILGdDigBMIKSAg==",
      "ClkKDmlkMDY5MTYtODU4NjExIg5CDEFwcC5mc29jaWV0eSo3IgkaA3VzYSICY2FyA2lvc6IBJDJkNDA1ZTlhLTU2Y2MtNGQ1YS04ZGNjLTg1Nzc4ZDhiZjdkNxACGNXyBCCN1Q4oATD6cQ==",
      "CmMKDmlkMDQ3MDMtODUwNTc3Ig5CDEFwcC5mc29jaWV0eSo3IgkaA3VzYSICbnlyA2lvc6IBJDMxMDQyMTlhLTExYTYtNGQ0ZS05NGRhLWU4ZTM3YjI3ZDAzYWoIYmE0Mzc2ODUQFRiYcSCXmQ4oATDQlAE=",
      "Co4BCg5pZDAyNTQ2LTcwMTQyMyIOQgxBcHAuZnNvY2lldHkqNyIJGgN1c2EiAk5ZcgNpT3OiASQzMTA0MjE5YS0xMWE2LTRkNGUtOTRkYS1lOGUzN2IyN2QwM2FiCGJhOTc2NjExaghiYTI5ODY4MmoJYmExMjc2ODM3ggEIYmExNDAzODOKAQhiYTc2MzM1NhAJGNi5AyCktwkoATDAqQE=",
      "CnIKDmlkMDI3ODQtNTY3NzczIg5CDEFwcC5mc29jaWV0eSo7IgkaA1VTQSICbnlyB2FuZHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmViCGJhNDYyOTcyagliYTEyMDk5MjEQAhjpqQMghswPKAEwwnY=",
      "CmkKDmlkMDk4NDAtNjk3MDc0Ig5CDEFwcC5mc29jaWV0eSo7IgkaA1VzYSICbnlyB2FuZHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmWKAQliYTEwNzM4NDkQCRjAqAMgia8MKAEwp+sB",
      "CnIKDmlkMDk5NjgtODY3MDQ4Ig5CDEFwcC5mc29jaWV0eSo7IgkaA3VzYSICbnlyB0FuZHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmViCGJhMTI0NzI3ggEIYmExODMxMTMQARil6gQguawNKAEw9ckB",
      "CnMKDmlkMDczOTYtMzkxNTg4Ig5CDEFwcC5mc29jaWV0eSo7IgkaA3VzQSICbnlyB2FOZHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmWCAQhiYTE0OTM3OIoBCGJhMjc4MTM5EAQYx+gCIOLiDygBMPSIAQ==",
      "CocBCg5pZDA2NTY0LTQ3NjgzNiIOQgxBcHAuZnNvY2lldHkqPCIKGgNCUkEiA3NhbnIHYW5Ecm9pZKIBJDQzNTEwYjVlLThkNzctNDVkNi1iYTVjLTZiZmNmYWZjMjliZWIHYmE3OTk3M2IIYmE1MTIwOTeCAQhiYTQ4NzU2OIoBCGJhNjkzOTI3EAIYgaoDINzBDCgBMJpC",
      "CogBCg5pZDA0MDMwLTk5MjA4MyIOQgxBcHAuZnNvY2lldHkqPCIKGgNNRVgiA2NhbnIHYW5kUm9pZKIBJDQzNTEwYjVlLThkNzctNDVkNi1iYTVjLTZiZmNmYWZjMjliZWIIYmE0ODg4NTZqCGJhNTUyMTk0ggEIYmE1OTYyMzaKAQhiYTM5OTIzORAVGPaZBCDnjA0oATClHg==",
      "CmoKDmlkMDA5OTAtNTg4MzkyIg5CDEFwcC5mc29jaWV0eSo9IgsaA0tPUiIEamVqdXIHYW5kck9pZKIBJDQzNTEwYjVlLThkNzctNDVkNi1iYTVjLTZiZmNmYWZjMjliZYoBCGJhNjg4MjA1EAIY/PoDIJecDygBMPGMAg==",
      "CnIKDmlkMDk0ODctMjMwMDkwIg5CDEFwcC5mc29jaWV0eSo7IgkaA0NBTiICT05yB2FuZHJvSWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmViCGJhNzg4MDAzggEIYmE2NTUxNTEQAhjjhgEg8tEOKAEw/ks=",
      "ClwKDmlkMDc0OTgtNDU4Mzc3Ig5CDEFwcC5mc29jaWV0eSo6IggaA0ZSQSIBcHIHYW5kcm9pRKIBJDQzNTEwYjVlLThkNzctNDVkNi1iYTVjLTZiZmNmYWZjMjliZRAWGPrvBCDX5g4oATCOwAE=",
      "CnQKDmlkMDM0MDUtNzMzNTQxIg5CDEFwcC5mc29jaWV0eSo7IgkaA0RFTiICZnJyB0FORHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmWCAQliYTExMTk3ODaKAQhiYTE5MjY4NhACGLn5AiClqA0oATCHhwI=",
      "CmsKDmlkMDQzNjItMjYyNzQ0Ig5CDEFwcC5mc29jaWV0eSo/Ig0aA0dCUiIGbG9uZG9ucgdhbmRST0lkogEkNDM1MTBiNWUtOGQ3Ny00NWQ2LWJhNWMtNmJmY2ZhZmMyOWJlaghiYTM0NzE3ORACGMiYBCCzkQsoATC2GA==",
      "CmwKDmlkMDEzMDItNDA2MDQ0Ig5CDEFwcC5mc29jaWV0eSo+IgwaA0lUQSIFbWlsYW5yB2FuZHJvaWSiASQ0MzUxMGI1ZS04ZDc3LTQ1ZDYtYmE1Yy02YmZjZmFmYzI5YmWCAQliYTEwNDc2MDYQAhjXmQQgyJUJKAEwoAo=",
      "CoABCg5pZDAxMTQwLTkxNjc0NyIOQgxBcHAuZnNvY2lldHkqPiIMGgNKUE4iBWt5b3RvcgdhbmRyb2lkogEkNDM1MTBiNWUtOGQ3Ny00NWQ2LWJhNWMtNmJmY2ZhZmMyOWJlaghiYTIwMjE0MGoIYmEzMzQzMzmKAQliYTEyMTYzMzcQAhj5nAUgx/8NKAEwi3E=",
      "CncKDmlkMDkyODctMjg0NjcyIg5CDEFwcC5mc29jaWV0eSo/Ig0aA0NITiIGcGVraW5ncgdhbmRyb2lkogEkNDM1MTBiNWUtOGQ3Ny00NWQ2LWJhNWMtNmJmY2ZhZmMyOWJlagliYTExNzYzMzKKAQhiYTQzMTE2MxACGM2MAyC+4QcoATDXMQ==",
      "CmgKDmlkMDE3NDQtNzQyMDEyIg9CDUFwcC5mc29jaWV0eTEqOyIJGgNVU0EiAm55cgdhbmRyb2lkogEkNTc4MTk2YTYtNzIyZS00NDFhLWIwMTctZGU2OTJjY2RmNWI4YghiYTc5Njg0ORACGNyvBSCQmgkoATC8hwE=",
      "Cn4KDmlkMDU2NDktNDIzNDQxIg9CDUFwcC5mc29jaWV0eTIqOyIJGgNVU0EiAm55cgdhbmRyb2lkogEkNTc4MTk2YTYtNzIyZS00NDFhLWIwMTctZGU2OTJjY2RmNWI4YghiYTUzNjg2MmoIYmE5MDAxMjOCAQliYTEwOTIyNjAQCRjh5QIg7cQHKAEwlqcB",
      "CnIKDmlkMDg4NjMtMzEwOTEzIg9CDUFwcC5mc29jaWV0eTMqOyIJGgNVU0EiAm55cgdBbmRyb2lkogEkNTc4MTk2YTYtNzIyZS00NDFhLWIwMTctZGU2OTJjY2RmNWI4YghiYTI5OTI0OGIIYmE0MDE1NzkQARi8byCulBAoATD15AE=",
      "CnQKDmlkMDc1MjktNzA5MTcxIg9CDUFwcC5mc29jaWV0eTQqOyIJGgNVU0EiAm55cgdhTmRyb2lkogEkNTc4MTk2YTYtNzIyZS00NDFhLWIwMTctZGU2OTJjY2RmNWI4YgliYTEwMzI0NDhqCWJhMTA1NDUzOBAEGMy4ASDX7A4oATC52wE=",
      "CnwKDmlkMDE4MjItMzQ1ODg4Ig9CDUFwcC5mc29jaWV0eTUqOyIJGgNVU0EiAk5ZcgdhbkRyb2lkogEkNTc4MTk2YTYtNzIyZS00NDFhLWIwMTctZGU2OTJjY2RmNWI4YghiYTM5NTY2N2IIYmE1NjA2NDhqCGJhNDY0ODA5EAIYy8UDILO0BygBMOnVAQ==",
      "Cl0KDmlkMDg2ODAtNjIwMjU1Ig5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDgQARi97AMg9ekIKAEw0oUB",
      "CnwKDmlkMDMxMTYtMjU3MzA1Ig5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhNTg1MDg0aghiYTQ0MDM0MYIBCGJhMzE5MjY2EAEY274EIJjoDCgBMO3mAQ==",
      "Cl0KDmlkMDk3OTYtODU0NjAxIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDgQAhjUZyDk/wsoATCcFQ==",
      "Cn4KDmlkMDcwMTYtODA0ODUwIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCWJhMTEyNjU1MGIIYmE0NzI0ODSKAQliYTExOTc0MDkQAhio2wQg6+IPKAEwvOYB",
      "CmgKDmlkMDc3MDUtNDQ0MTYwIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCWJhMTAxMDQxOBADGPbXASCanA4oATD/Cg==",
      "CogBCg5pZDA1MTczLTE0MTY3NyIOQgxBcHAuYWJ1c2luZzIqOyIJGgNVU0EiAldBcgdhbmRyb2lkogEkNjc5ZDgyYjMtOGFhYi00OTk1LTllYWUtZWM3ZjkyMjUxOWQ4YgliYTEwNDQ2MzdqCGJhMjIzMzU1ggEIYmE4MjMxMzmKAQhiYTI5NzI4MhADGInvAyDsiQsoATDnMw==",
      "CnMKDmlkMDQzNTgtODczMjAyIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiCAQhiYTI3Nzk2OYoBCGJhOTYxNDIyEAQY9dUBIL3XDSgBMJ1f",
      "CqkBCg5pZDAwMTcwLTM3NTc0MyIOQgxBcHAuYWJ1c2luZzIqOyIJGgNVU0EiAldBcgdhbmRyb2lkogEkNjc5ZDgyYjMtOGFhYi00OTk1LTllYWUtZWM3ZjkyMjUxOWQ4YghiYTQ1NDI4N2oIYmE5MTk3MDVqCWJhMTAwNzc3MYIBCGJhNDA0OTAzggEIYmEzNjk3MjOKAQliYTExMDgzMzaKAQhiYTM3OTIwOBAEGMToAyD50AooATDaPw==",
      "CnsKDmlkMDA4NDktMzkyMDIwIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiB2JhNTAwMDlqCGJhNjY4MDk4igEIYmExMDY0MTIQBRj6tAIgxvULKAEwziQ=",
      "CnIKDmlkMDU3NTktNDc3NzY3Ig5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhqCGJhNDAzMTUyigEIYmEzMDc0MTMQBRiA3wQg86MGKAEwql0=",
      "CnIKDmlkMDUwMDAtNDI0NjE5Ig5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhODc2MzIyigEIYmE4NTM5OTcQBhjR9wIg8f0QKAEwul0=",
      "CmgKDmlkMDg1NDUtOTEwMDcxIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiCAQhiYTcyODI2NxAGGPm7AyCtiwsoATDiCQ==",
      "CmgKDmlkMDc1OTYtMzU5MTIxIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiKAQhiYTkyNTA5MxAHGPXDASCE9A4oATCS0gE=",
      "Cn0KDmlkMDU5ODYtNTE5MTA2Ig5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhNTk4OTc2agliYTEwMDczODWKAQhiYTg4NTkxORAHGOzRAiDg7AwoATCbTA==",
      "CnMKDmlkMDYzNzEtNzIxODI0Ig5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCWJhMTA3MDI1MooBCGJhMTQ1Njc5EAgYlYIDILqsDygBMMDiAQ==",
      "Cn0KDmlkMDE5ODMtMDYzMTkzIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhOTU2Mzk3aghiYTk1MDY5MoIBCWJhMTAwODY2NhAIGOPSAiD5hgkoATCqxAE=",
      "CnQKDmlkMDI1NzEtNDQyNzcwIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhqCWJhMTA2Njk1OIIBCWJhMTAyOTQ1MhAJGI79AyDimQ8oATCWJw==",
      "CnEKDmlkMDI5NTQtNzQ3Nzk5Ig5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiB2JhNjg4NDGKAQhiYTU0MTA2NRAJGIbaAyDCyBAoATCHaQ==",
      "CmgKDmlkMDE4ODAtNDYxMjUzIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiKAQhiYTU1MDc4NBAKGMP9AyCD2AcoATDUCg==",
      "CnMKDmlkMDQ3MzgtOTA2MjQyIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhNjY3ODAzigEJYmExMDg5Njc5EAoYpnkgnvINKAEwg14=",
      "Cn4KDmlkMDQyNzctNjgyNjkyIg5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiCAQhiYTc1MzEwNYoBCGJhMzYzMzQ0igEIYmE1NzUzNDEQFRj5ZSDA0A4oATC6/gE=",
      "Cl0KDmlkMDYyMDItNTQwNDAyIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDgQFRiNjQQgpM0GKAEwt6sB",
      "CnIKDmlkMDUzMjEtMjAwMjU0Ig5CDEFwcC5hYnVzaW5nMSo7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDhiCGJhNDA3NjQwigEIYmE1MjM3NDAQFhjT4QEg8fwPKAEwotsB",
      "CmgKDmlkMDI0NDgtNDU4NzUxIg5CDEFwcC5hYnVzaW5nMio7IgkaA1VTQSICV0FyB2FuZHJvaWSiASQ2NzlkODJiMy04YWFiLTQ5OTUtOWVhZS1lYzdmOTIyNTE5ZDiKAQhiYTE3MjU2MBAWGLSTASD63QsoATC+ugE=",
      "CogBCg5pZDA0Mjk5LTY5NTExOSINQgtBcHAubm9ubzY1NSo7IgkaA1VTQSICbjhyB2FuZHJvaWSiASQ3ZGQyYTA2MC02MWRhLTQ4ODgtYWFiYS0yZDdmNTdmMmUxNGNqCWJhMTAyMTE4MIIBCGJhOTg4NjA5ggEIYmEyMjk0MjmKAQhiYTgzMDI3NRABGIXDAyDonAooATDJngE=",
      "CnwKDmlkMDU0MTctMjQ5NTk4Ig1CC0FwcC5ub25vNTc2KjsiCRoDVVNBIgJuMHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oIYmEyOTg1MDGCAQhiYTI1NDQ4N4oBCGJhNDQ0ODg0EAEYze8EIOG+CSgBMJf5AQ==",
      "CmgKDmlkMDQyNjUtNDE4NTY1Ig1CC0FwcC5ub25vMzY2KjsiCRoDVVNBIgJuNXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y4oBCWJhMTA5NTExORACGI2TAiDmvBAoATDetwE=",
      "Cn0KDmlkMDkwNzMtNjI1NzcyIgxCCkFwcC5ub25vNDEqOyIJGgNVU0EiAm41cgdhbmRyb2lkogEkN2RkMmEwNjAtNjFkYS00ODg4LWFhYmEtMmQ3ZjU3ZjJlMTRjggEJYmExMjEyNDA5igEIYmEzNTk2MDSKAQhiYTIxNjY3MhACGMuKBCDV4wsoATCfFw==",
      "CnwKDmlkMDczOTYtMjc3NTU0Ig1CC0FwcC5ub25vMzMwKjsiCRoDVVNBIgJuMHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oJYmExMjcxNjcwggEHYmE2Njc1NYIBCGJhOTM0NzMzEAMY3ZAEIIThDSgBMLc+",
      "CnAKDmlkMDAxMTItMTIwNDI3Ig1CC0FwcC5ub25vMzQxKjsiCRoDVVNBIgJuMXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmExMTUyNTZqCGJhNTcxOTA1EAMYj5cFIL+CCCgBMJ6/AQ==",
      "CoYBCg5pZDA5OTIwLTQyMDMwOCINQgtBcHAubm9ubzc3NCo7IgkaA1VTQSICbjNyB2FuZHJvaWSiASQ3ZGQyYTA2MC02MWRhLTQ4ODgtYWFiYS0yZDdmNTdmMmUxNGNiCGJhOTg4ODY3aghiYTYxMDgxNYIBCGJhNzMzMTc4igEIYmE0OTg4OTcQBBiGggQg9dsHKAEw7/EB",
      "CmcKDmlkMDE5NTAtNTE5NDc5Ig1CC0FwcC5ub25vOTE3KjsiCRoDVVNBIgJuM3IHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IJYmExMDQ3OTc5EAQYwckEIOOPDygBMJQw",
      "CmUKDmlkMDQ5OTctOTkxODE1Ig1CC0FwcC5ub25vMjIwKjsiCRoDVVNBIgJuOHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oHYmE2ODA1NxAFGP+iBSD6mQwoATDNiwI=",
      "CoUBCg5pZDAwNjIwLTcwMzM4OCIMQgpBcHAubm9ubzgxKjsiCRoDVVNBIgJuOXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmE1ODIzNzdqCGJhODk2NTQwaghiYTc2NDQwOIIBCWJhMTA3ODI3NhAFGIa9AiCVygYoATDE2gE=",
      "Cn0KDmlkMDkwMDYtODIyMzU4Ig1CC0FwcC5ub25vMzMwKjsiCRoDVVNBIgJuNHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oIYmExMzQ3OTmCAQliYTExMjc3MDOKAQhiYTMzOTczNBAGGNbxAiDKuA0oATD96AE=",
      "CnAKDmlkMDU3MDUtOTE4NjczIg1CC0FwcC5ub25vMTAwKjsiCRoDVVNBIgJuNHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmEzNTEwMzlqCGJhNjk0OTA2EAYYzfkCIN/SCSgBMPncAQ==",
      "CnEKDmlkMDU0ODMtMzg5Nzg3Ig1CC0FwcC5ub25vNzAwKjsiCRoDVVNBIgJuNXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oIYmE5NjcxMziKAQhiYTY4Njg2MRAHGO+SAyCwlwYoATC6Ug==",
      "Cn0KDmlkMDM2NzAtMTMyMTYxIg1CC0FwcC5ub25vMTMwKjsiCRoDVVNBIgJuNHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oIYmE0NDI4MzeCAQhiYTI5NDYzM4oBCWJhMTI2MjIzNxAHGKvuBCCQzQsoATD8kwE=",
      "CnEKDmlkMDU5ODctMjY2Mjc3Ig1CC0FwcC5ub25vNjQ3KjsiCRoDVVNBIgJuMXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmExMjAyODBqCWJhMTI0MDM4ORAIGKWCAyDhywYoATCdEQ==",
      "Cn8KDmlkMDI2NDgtMjAwMDA0Ig1CC0FwcC5ub25vNjM1KjsiCRoDVVNBIgJuM3IHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y4IBCWJhMTI1Nzc4OIoBCGJhODU4NjQ4igEJYmExMTg4Njc3EAgY1/UBINbkDygBMK+UAg==",
      "Cn0KDmlkMDQ2ODctODE1MTkzIg1CC0FwcC5ub25vNzQ5KjsiCRoDVVNBIgJuOXIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y4IBCGJhNTUwNjg1igEIYmE0MzcwNDWKAQhiYTk0NTkyOBAJGPyqASDB/wgoATDBWA==",
      "CnEKDmlkMDgyMTktNTI2NTkxIg1CC0FwcC5ub25vOTA0KjsiCRoDVVNBIgJuN3IHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmE2ODY2ODBiCWJhMTEwOTc5NRAJGKa4AiCmmwsoATC7Vg==",
      "CnwKDmlkMDg3OTEtNDgwNTIyIg1CC0FwcC5ub25vOTg5KjsiCRoDVVNBIgJuMnIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2IIYmE4NzY4NTJiCGJhMTA2MjkxggEJYmExMjUxMjI0EAoYyKwDINm3CCgBMOgq",
      "CnsKDmlkMDc5NjYtNTA1MjQ3Ig1CC0FwcC5ub25vODY0KjsiCRoDVVNBIgJuOHIHYW5kcm9pZKIBJDdkZDJhMDYwLTYxZGEtNDg4OC1hYWJhLTJkN2Y1N2YyZTE0Y2oIYmE5NDM0MTFqCGJhMjE0ODYzggEIYmExMTMxODkQChjqhQIgnKwMKAEwq7MB",
      "CnsKDmlkMDYzOTEtNzExMTE0IhFCD0FwcC5zb21ldGhpbmcyNSo3IgkaA1VTQSICYzNyA2lPU6IBJDg5ODU5YzhmLTEyYmUtNDJmYy1iMGFlLWNmNjNkNjNmMDBmZmIIYmE5MzE3OThiCGJhMjU3MzI0igEIYmEyOTAxNDYQCRjwrwQgg5kOKAEwqg4=",
      "CnwKDmlkMDg5MzgtNzA4MDYxIhJCEEFwcC5zb21ldGhpbmc4MDQqNyIJGgNVU0EiAmM0cgNpT1OiASQ4OTg1OWM4Zi0xMmJlLTQyZmMtYjBhZS1jZjYzZDYzZjAwZmZiCWJhMTE0MjUzNmIIYmE1ODUwNzlqCGJhNjI5MTQwEAkYj6cBIOHdCygBMMa/AQ==",
      "CoUBCg5pZDAxNTc0LTU1MTE1NCIRQg9BcHAuc29tZXRoaW5nNDgqNyIJGgNVU0EiAmMzcgNpT1OiASQ4OTg1OWM4Zi0xMmJlLTQyZmMtYjBhZS1jZjYzZDYzZjAwZmZqCGJhNzgzMzM2aghiYTExOTQ3NGoIYmExNDg0NTaCAQhiYTMwMDc1NRAJGJ/lASCM8g4oATDBqgE=",
      "CnEKDmlkMDY0NDctOTg4NzU3IhJCEEFwcC5zb21ldGhpbmc1MjIqNyIJGgNVU0EiAmM2cgNpT1OiASQ5NWYxOTVmOC1hMTU5LTRkMzUtYmYyZi03ODUyMDlkM2NmMGZiCGJhODU5Mzc4aghiYTU5NzIwMhAKGOPTASCZ1w4oATDJ+gE=",
      "CnIKDmlkMDkwNDQtNzMzNzc0IhJCEEFwcC5zb21ldGhpbmcyMzkqNyIJGgNVU0EiAmMzcgNpT1OiASQ5NWYxOTVmOC1hMTU5LTRkMzUtYmYyZi03ODUyMDlkM2NmMGZiCWJhMTE0ODc5NGIIYmEyMjIxMDQQChjhwQMg6+4KKAEw8Ck=",
      "Cn8KDmlkMDU3MTktMjU0ODYzIhJCEEFwcC5zb21ldGhpbmc2ODgqNyIJGgNVU0EiAmM3cgNpT1OiASQ5NWYxOTVmOC1hMTU5LTRkMzUtYmYyZi03ODUyMDlkM2NmMGZiCGJhOTY0MjIzggEJYmExMTgzMTA5ggEJYmExMjU1MTE1EAoYo6cFIMjABigBMKhD",
      "CnEKDmlkMDE2NzktNzA3MDE5IhJCEEFwcC5zb21ldGhpbmc2OTcqNyIJGgNVU0EiAmM3cgNpT1OiASRhZGZhYmQ1Mi1hODgzLTQ5ZTQtOGY1Ny0yNDZkYjVmZmY3YjNqCGJhNDA4NDc1aghiYTIxMjA5MxABGKGhAyDJqQ4oATCZ1AE=",
      "CmgKDmlkMDY4MTktNjY0ODczIhJCEEFwcC5zb21ldGhpbmcyMDYqNyIJGgNVU0EiAmM2cgNpT1OiASRhZGZhYmQ1Mi1hODgzLTQ5ZTQtOGY1Ny0yNDZkYjVmZmY3YjNqCWJhMTI1ODg3MBABGLHLASCZ2QsoATDoew==",
      "CogBCg5pZDA2NTIyLTk1NzgyNSISQhBBcHAuc29tZXRoaW5nMjY0KjciCRoDVVNBIgJjNXIDaU9TogEkYWRmYWJkNTItYTg4My00OWU0LThmNTctMjQ2ZGI1ZmZmN2IzaghiYTgxNzQyMYIBCGJhMjQ5MTc2ggEIYmEyMjcwNTWKAQhiYTk5NDY0ORABGL7QAyCnrRAoATD4FA==",
      "CnMKDmlkMDg2NjAtNDMzMjUxIhJCEEFwcC5zb21ldGhpbmc3NTkqNyIJGgNVU0EiAmMzcgNpT1OiASRiMDIzYTBlZS0zNWMzLTQyMDktOWZmZi1hMmU0NTI0ZGI1NzVqCGJhMTc5MzM4ggEJYmExMjEwODI0EAIYi/cCIML+BygBMIs5",
      "CnEKDmlkMDkzMDMtMTg4OTQzIhJCEEFwcC5zb21ldGhpbmc5MDQqNyIJGgNVU0EiAmM5cgNpT1OiASRiMDIzYTBlZS0zNWMzLTQyMDktOWZmZi1hMmU0NTI0ZGI1NzViB2JhNjM2NDeKAQhiYTc2NTI0MxACGLCMASDTzwYoATDiowE=",
      "CmcKDmlkMDgyODgtMzAwMjQ5IhJCEEFwcC5zb21ldGhpbmc4OTgqNyIJGgNVU0EiAmMycgNpT1OiASRiMDIzYTBlZS0zNWMzLTQyMDktOWZmZi1hMmU0NTI0ZGI1NzWKAQdiYTUwODM5EAIY94cEIK6wCigBMPDFAQ==",
      "Cn4KDmlkMDYwMzYtNDc0Mjk3IhJCEEFwcC5zb21ldGhpbmc4MjQqNyIJGgNVU0EiAmM4cgNpT1OiASRjNzcwY2QyNS01ZWJhLTQ5YzEtYTJjNS01YmM0YTE2MTUzOWSCAQhiYTUyMTQ1NYIBCGJhNTE5MzI4igEIYmExNzI0ODcQAxjv+QMg55cPKAEw4Bs=",
      "CnwKDmlkMDUzNjctMTgxNTM0IhJCEEFwcC5zb21ldGhpbmcyNTkqNyIJGgNVU0EiAmMzcgNpT1OiASRjNzcwY2QyNS01ZWJhLTQ5YzEtYTJjNS01YmM0YTE2MTUzOWRiCGJhNDQzNDA4aghiYTY4MDE2MYoBCGJhMzIyODk0EAMYubMFIISRCSgBMMawAQ==",
      "CnEKDmlkMDkwNDQtMjA4OTQ5IhJCEEFwcC5zb21ldGhpbmczMDMqNyIJGgNVU0EiAmMwcgNpT1OiASRjNzcwY2QyNS01ZWJhLTQ5YzEtYTJjNS01YmM0YTE2MTUzOWRiCGJhODY2MDc2aghiYTYzMTkxMRADGJPKAiD8jA8oATDVkgI=",
      "CoABCg5pZDA3NzcwLTg2NDE4NCISQhBBcHAuc29tZXRoaW5nMzk1KjciCRoDVVNBIgJjNHIDaU9TogEkZDhhMWMyZDEtOWM5ZS00ZGU4LTgyM2UtMTAxODMwNTlmOWIxagliYTExMjk3NDWCAQliYTEwNDYxMjCKAQliYTEwOTQyMDAQBBjkzwIgstgMKAEwuUE=",
      "CpIBCg5pZDAwMjMyLTI1NTI5MiIRQg9BcHAuc29tZXRoaW5nMzcqNyIJGgNVU0EiAmM3cgNpT1OiASRkOGExYzJkMS05YzllLTRkZTgtODIzZS0xMDE4MzA1OWY5YjFiCGJhMTM0OTU1aghiYTYyOTU2OYIBCGJhMjE0OTk5ggEIYmE1Njc0NjCKAQliYTEwMzI3ODEQBBjd6QMg8e0NKAEwj4MB",
      "CocBCg5pZDAzMDIxLTU3MzA1OCIRQg9BcHAuc29tZXRoaW5nNzgqNyIJGgNVU0EiAmM0cgNpT1OiASRkOGExYzJkMS05YzllLTRkZTgtODIzZS0xMDE4MzA1OWY5YjFiCGJhODA0NjI1agliYTExMDM0NDSKAQhiYTM5ODUzNIoBCGJhODkyMDI2EAQY1b0FIKjbCCgBMJdx",
      "CokBCg5pZDA5OTM3LTc2MTI4OSISQhBBcHAuc29tZXRoaW5nMjUzKjciCRoDVVNBIgJjNHIDaU9TogEkZTU3NjhhNDktZGNjZS00YTc0LWEyNWEtNmRjZmQyMmQ0ZjQ4YgliYTEyMDY5OTOCAQhiYTU4NDk3N4IBCGJhNzEzMzIzigEIYmEyNTIwOTUQBRi9sgUg+JQHKAEwwZgB",
      "CmgKDmlkMDU2NDEtNTU2OTY1IhJCEEFwcC5zb21ldGhpbmcyOTYqNyIJGgNVU0EiAmM4cgNpT1OiASRlNTc2OGE0OS1kY2NlLTRhNzQtYTI1YS02ZGNmZDIyZDRmNDiCAQhiYTI1MzQ2NxAFGNW8AiC1sg4oATCCrQE=",
      "CnEKDmlkMDQzMTAtOTY5OTM1IhJCEEFwcC5zb21ldGhpbmc2MjYqNyIJGgNVU0EiAmM2cgNpT1OiASRlNTc2OGE0OS1kY2NlLTRhNzQtYTI1YS02ZGNmZDIyZDRmNDhiCGJhNzg1MDAxaghiYTgzNTE1MBAFGIesAyCcqAkoATCl/gE=",
      "CnMKDmlkMDczMjUtNTAyMDI3IhJCEEFwcC5zb21ldGhpbmc1MDYqNyIJGgNVU0EiAmMzcgNpT1OiASRmYjk2NzU1My1kZWE1LTRlMzAtODFkNC01NzIwYTAyN2NkODSKAQhiYTc5MDA0OYoBCGJhMTI5Njg2EAYY08EEIIeQDSgBMJDhAQ==",
      "CnwKDmlkMDA1MjgtODQzOTUxIhJCEEFwcC5zb21ldGhpbmc5OTQqNyIJGgNVU0EiAmMzcgNpT1OiASRmYjk2NzU1My1kZWE1LTRlMzAtODFkNC01NzIwYTAyN2NkODRiCGJhMTU1MzM0aghiYTg2ODYwNIIBCGJhNTE5MTMxEAYY2MgDIPzxCigBML/dAQ==",
      "CnIKDmlkMDYzMDUtMzQxMTY0IhFCD0FwcC5zb21ldGhpbmczMCo3IgkaA1VTQSICYzdyA2lPU6IBJGZiOTY3NTUzLWRlYTUtNGUzMC04MWQ0LTU3MjBhMDI3Y2Q4NGoJYmExMDk3NDQyigEIYmEyNTk5ODIQBhi68wQg9ZgLKAEw1oEB"};

  Function<String, DeviceProfile> dpParser = x -> {
    try {
      return getDpWithCanonicalId(DeviceProfile.parseFrom(Base64.getDecoder().decode(x)));
    } catch (InvalidProtocolBufferException e) {
      e.printStackTrace();
    }
    return null;
  };

  Function<String, AppProfile> apParser = x -> {
    try {
      return AppProfile.parseFrom(Base64.getDecoder().decode(x));
    } catch (InvalidProtocolBufferException e) {
      e.printStackTrace();
    }
    return null;
  };

  @Test
  public void testDeviceProfiles() {
    Set<DeviceProfile> expectedDeviceProfiles = Arrays.asList(
        "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")
        .stream().map(dpParser).collect(Collectors.toSet());

    PCollection<byte[]> rawData = tp.apply(Create.of(Arrays.asList(bidLogsB64)))
        .apply(MapElements.into(TypeDescriptor.of(byte[].class)).via((String b) -> Base64.getDecoder().decode(b)));

    PCollection<DeviceProfile> deviceProfiles = rawData.apply(new BidLog2DeviceProfile());

    PAssert.that(deviceProfiles).satisfies(out -> {
      assertEquals(16, Iterables.size(out));
      Set<DeviceProfile> actualDeviceProfiles =
          StreamSupport.stream(out.spliterator(), false).map(x -> getDpWithCanonicalId(x)).collect(Collectors.toSet());
      try {
        assertTrue(areDeviceProfileSetsEqual(expectedDeviceProfiles, actualDeviceProfiles));
      } catch (InvalidProtocolBufferException e) {
        e.printStackTrace();
      }
      return null;
    });

    tp.run();
  }

  @Test
  public void testAppProfiles() {
    Set<AppProfile> expectedAppProfiles = Arrays.asList("Cg1BcHAuZnNvY2lldHkyEAEaBAgJEAE=",
        "ChBBcHAuc29tZXRoaW5nODA0EAEaBAgJEAE=", "ChBBcHAuc29tZXRoaW5nNjg4EAEaBAgKEAE=",
        "Cg9BcHAuc29tZXRoaW5nMjUQARoECAkQAQ==", "Cg1BcHAuZnNvY2lldHk0EAEaBAgEEAE=",
        "CgxBcHAuZnNvY2lldHkQBRoECBUQBBoECBYQAhoECAEQARoECAIQBBoECAQQARoECAkQAg==",
        "Cg9BcHAuc29tZXRoaW5nMzcQARoECAQQAQ==", "Cg1BcHAuZnNvY2lldHkzEAEaBAgBEAE=",
        "ChBBcHAuc29tZXRoaW5nNTIyEAEaBAgKEAE=", "CgtBcHAubm9ubzM0MRABGgQIAxAB", "ChBBcHAuc29tZXRoaW5nMjU5EAEaBAgDEAE=",
        "ChBBcHAuc29tZXRoaW5nMjUzEAEaBAgFEAE=", "Cg1BcHAuZnNvY2lldHk1EAEaBAgCEAE=", "CgtBcHAubm9ubzYzNRABGgQICBAB",
        "CghhcHAuMTIzNBACGgQIFRACGgQIAhAC", "CgpBcHAubm9ubzQxEAEaBAgCEAE=",
        "CghBcHAuMTIzNBACGgQIFRABGgQICRABGgQIFhABGgQIAhAC", "Cg1BcHAuZnNvY2lldHkxEAEaBAgCEAE=",
        "CgtBcHAubm9ubzEwMBABGgQIBhAB", "CgpBcHAubm9ubzgxEAEaBAgFEAE=", "Cg9BcHAuc29tZXRoaW5nMzAQARoECAYQAQ==",
        "CgtBcHAubm9ubzkxNxABGgQIBBAB", "ChBBcHAuc29tZXRoaW5nMjA2EAEaBAgBEAE=", "ChBBcHAuc29tZXRoaW5nODk4EAEaBAgCEAE=",
        "CgtBcHAubm9ubzg2NBABGgQIChAB", "CgtBcHAubm9ubzIyMBABGgQIBRAB", "CgtBcHAubm9ubzk4ORABGgQIChAB",
        "ChBBcHAuc29tZXRoaW5nOTA0EAEaBAgCEAE=", "CgtBcHAubm9ubzkwNBABGgQICRAB", "ChBBcHAuc29tZXRoaW5nNjk3EAEaBAgBEAE=",
        "CgtBcHAubm9ubzY1NRABGgQIARAB", "Cg9BcHAuc29tZXRoaW5nNzgQARoECAQQAQ==", "CgtBcHAubm9ubzU3NhABGgQIARAB",
        "ChBBcHAuc29tZXRoaW5nNjI2EAEaBAgFEAE=", "CgtBcHAubm9ubzc3NBABGgQIBBAB", "CgtBcHAubm9ubzcwMBABGgQIBxAB",
        "CgtBcHAubm9ubzMzMBABGgQIBhABGgQIAxAB", "ChBBcHAuc29tZXRoaW5nODI0EAEaBAgDEAE=",
        "ChBBcHAuc29tZXRoaW5nNTA2EAEaBAgGEAE=",
        "CgxBcHAuYWJ1c2luZzEQARoECAoQARoECBUQARoECBYQARoECAMQARoECAIQARoECAcQARoECAgQARoECAQQARoECAkQARoECAYQARoECAUQARoECAEQAQ==",
        "CgxBcHAuYWJ1c2luZzIQARoECBYQARoECBUQARoECAIQARoECAMQARoECAQQARoECAYQARoECAcQARoECAgQARoECAkQARoECAoQARoECAUQARoECAEQAQ==",
        "CgtBcHAubm9ubzM2NhABGgQIAhAB", "CgtBcHAubm9ubzEzMBABGgQIBxAB", "ChBBcHAuc29tZXRoaW5nMjM5EAEaBAgKEAE=",
        "CgtBcHAubm9ubzY0NxABGgQICBAB", "ChBBcHAuc29tZXRoaW5nOTk0EAEaBAgGEAE=", "CgtBcHAubm9ubzc0ORABGgQICRAB",
        "ChBBcHAuc29tZXRoaW5nMjY0EAEaBAgBEAE=", "ChBBcHAuc29tZXRoaW5nNzU5EAEaBAgCEAE=",
        "ChBBcHAuc29tZXRoaW5nMzAzEAEaBAgDEAE=", "Cg9BcHAuc29tZXRoaW5nNDgQARoECAkQAQ==",
        "ChBBcHAuc29tZXRoaW5nMjk2EAEaBAgFEAE=", "ChBBcHAuc29tZXRoaW5nMzk1EAEaBAgEEAE=").stream().map(apParser)
        .collect(Collectors.toSet());

    PCollection<byte[]> rawData = tp.apply(Create.of(Arrays.asList(bidLogsB64)))
        .apply(MapElements.into(TypeDescriptor.of(byte[].class)).via((String b) -> Base64.getDecoder().decode(b)));

    PCollection<AppProfile> appProfiles = rawData.apply(new BidLog2DeviceProfile()).apply(new ComputeAppProfiles());

    PAssert.that(appProfiles).satisfies(out -> {
      assertEquals(53, Iterables.size(out));
      assertEquals(expectedAppProfiles, StreamSupport.stream(out.spliterator(), false).collect(Collectors.toSet()));
      return null;
    });

    tp.run();
  }

  @Test
  public void testSuspiciousIDs() {
    PCollection<byte[]> rawData = tp.apply(Create.of(Arrays.asList(bidLogsB64)))
        .apply(MapElements.into(TypeDescriptor.of(byte[].class)).via((String b) -> Base64.getDecoder().decode(b)));

    PCollection<DeviceProfile> deviceProfiles = rawData.apply(new BidLog2DeviceProfile());
    PCollection<AppProfile> appProfiles = deviceProfiles.apply(new ComputeAppProfiles());

    PAssert
        .that(getSuspiciousIDs(deviceProfiles, appProfiles, 4, 3, 8, 10)
            .apply(MapElements.into(TypeDescriptor.of(DeviceId.class)).via((DeviceId id) -> getCanonicalId(id))))
        .containsInAnyOrder(
            DeviceId.newBuilder().setOs(OsType.ANDROID).setUuid("679d82b3-8aab-4995-9eae-ec7f922519d8").build(), //
            DeviceId.newBuilder().setOs(OsType.ANDROID).setUuid("7dd2a060-61da-4888-aaba-2d7f57f2e14c").build(), //
            DeviceId.newBuilder().setOs(OsType.ANDROID).setUuid("43510b5e-8d77-45d6-ba5c-6bfcfafc29be").build(), //
            DeviceId.newBuilder().setOs(OsType.ANDROID).setUuid("578196a6-722e-441a-b017-de692ccdf5b8").build());

    tp.run();
  }
}
